Option Strict On
Option Explicit On 
Imports System.Data.SqlClient

Public Class frmSelTipoCobro
    Inherits System.Windows.Forms.Form
    Private Titulo As String = "Captura de cobranza"
    Private Consecutivo As Integer
    Public Cobro As SigaMetClasses.sCobro
    Public ImporteTotalCobro As Decimal = 0
    Private _TipoCobro As SigaMetClasses.Enumeradores.enumTipoCobro
    Private _CapturaDetalle As Boolean = True

    Public Sub New(ByVal intConsecutivo As Integer, _
          Optional ByVal CapturaDetalle As Boolean = True)

        MyBase.New()
        InitializeComponent()
        Consecutivo = intConsecutivo
        If CapturaEfectivoVales = True Then
            btnAceptarEfectivoVales.Enabled = False
        End If
        If CapturaMixtaEfectivoVales = True Then
            'btnAceptarEfectivo.Enabled = False
            'btnAceptarVale.Enabled = False
        End If
        _CapturaDetalle = CapturaDetalle
    End Sub

#Region " Windows Form Designer generated code "

    Public Sub New()
        MyBase.New()
        InitializeComponent()
    End Sub


    'Form overrides dispose to clean up the component list.
    Protected Overloads Overrides Sub Dispose(ByVal disposing As Boolean)
        If disposing Then
            If Not (components Is Nothing) Then
                components.Dispose()
            End If
        End If
        MyBase.Dispose(disposing)
    End Sub

    'Required by the Windows Form Designer
    Private components As System.ComponentModel.IContainer

    'NOTE: The following procedure is required by the Windows Form Designer
    'It can be modified using the Windows Form Designer.  
    'Do not modify it using the code editor.
    Friend WithEvents tabTipoCobro As System.Windows.Forms.TabControl
    Friend WithEvents dtpFechaCheque As System.Windows.Forms.DateTimePicker
    Friend WithEvents lblObservaciones As ControlesBase.LabelBase
    Friend WithEvents lblNoCheque As ControlesBase.LabelBase
    Friend WithEvents lblFechaCheque As ControlesBase.LabelBase
    Friend WithEvents lblNoCuenta As ControlesBase.LabelBase
    Friend WithEvents lblImporte As ControlesBase.LabelBase
    Friend WithEvents lblCliente As ControlesBase.LabelBase
    Friend WithEvents tbEfectivoVales As System.Windows.Forms.TabPage
    Friend WithEvents btnAceptarEfectivoVales As ControlesBase.BotonBase
    Friend WithEvents grpEfectivoVales As System.Windows.Forms.GroupBox
    Friend WithEvents lblTotalEfectivoVales As ControlesBase.LabelBase
    Friend WithEvents imgLista As System.Windows.Forms.ImageList
    Friend WithEvents tbTarjetaCredito As System.Windows.Forms.TabPage
    Friend WithEvents grpTarjetaCredito As System.Windows.Forms.GroupBox
    Friend WithEvents Label20 As ControlesBase.LabelBase
    Friend WithEvents LabelBase1 As ControlesBase.LabelBase
    Friend WithEvents LabelBase2 As ControlesBase.LabelBase
    Friend WithEvents LabelBase3 As ControlesBase.LabelBase
    Friend WithEvents btnAceptarTarjetaCredito As ControlesBase.BotonBase
    Friend WithEvents Label21 As ControlesBase.LabelBase
    Friend WithEvents lblTarjetaCredito As System.Windows.Forms.Label
    Friend WithEvents lblTitular As System.Windows.Forms.Label
    Friend WithEvents lblTipoTarjetaCredito As System.Windows.Forms.Label
    Friend WithEvents LabelBase4 As ControlesBase.LabelBase
    Friend WithEvents lblVigencia As System.Windows.Forms.Label
    Friend WithEvents LabelBase5 As ControlesBase.LabelBase
    Friend WithEvents btnBuscarClienteTC As System.Windows.Forms.Button
    Friend WithEvents LabelBase6 As ControlesBase.LabelBase
    Friend WithEvents lblBancoNombre As System.Windows.Forms.Label
    Friend WithEvents LabelBase7 As ControlesBase.LabelBase
    Friend WithEvents lblClienteNombre As System.Windows.Forms.Label
    Friend WithEvents lblBanco As System.Windows.Forms.Label
    Friend WithEvents ComboBanco As SigaMetClasses.Combos.ComboBanco
    Friend WithEvents txtObservaciones As System.Windows.Forms.TextBox
    Friend WithEvents txtTotalEfectivoVales As SigaMetClasses.Controles.txtNumeroDecimal
    Friend WithEvents txtNumeroCuenta As SigaMetClasses.Controles.txtNumeroEntero
    Friend WithEvents txtClienteCheque As SigaMetClasses.Controles.txtNumeroEntero
    Friend WithEvents txtClienteTC As SigaMetClasses.Controles.txtNumeroEntero
    Friend WithEvents txtImporteTC As SigaMetClasses.Controles.txtNumeroDecimal
    Friend WithEvents btnAceptarChequeFicha As ControlesBase.BotonBase
    Friend WithEvents tbChequeFicha As System.Windows.Forms.TabPage
    Friend WithEvents grpChequeFicha As System.Windows.Forms.GroupBox
    Friend WithEvents rbCheque As System.Windows.Forms.RadioButton
    Friend WithEvents rbFicha As System.Windows.Forms.RadioButton
    Friend WithEvents txtDocumento As SigaMetClasses.Controles.txtNumeroEntero
    Friend WithEvents txtImporteDocumento As SigaMetClasses.Controles.txtNumeroDecimal
    Friend WithEvents btnBuscarCliente As System.Windows.Forms.Button
    Friend WithEvents lblNombre As System.Windows.Forms.Label
    Friend WithEvents rbNotaCredito As System.Windows.Forms.RadioButton
    <System.Diagnostics.DebuggerStepThrough()> Private Sub InitializeComponent()
        Me.components = New System.ComponentModel.Container()
        Dim resources As System.Resources.ResourceManager = New System.Resources.ResourceManager(GetType(frmSelTipoCobro))
        Me.tabTipoCobro = New System.Windows.Forms.TabControl()
        Me.tbEfectivoVales = New System.Windows.Forms.TabPage()
        Me.grpEfectivoVales = New System.Windows.Forms.GroupBox()
        Me.txtTotalEfectivoVales = New SigaMetClasses.Controles.txtNumeroDecimal()
        Me.lblTotalEfectivoVales = New ControlesBase.LabelBase()
        Me.btnAceptarEfectivoVales = New ControlesBase.BotonBase()
        Me.tbTarjetaCredito = New System.Windows.Forms.TabPage()
        Me.btnAceptarTarjetaCredito = New ControlesBase.BotonBase()
        Me.grpTarjetaCredito = New System.Windows.Forms.GroupBox()
        Me.txtImporteTC = New SigaMetClasses.Controles.txtNumeroDecimal()
        Me.txtClienteTC = New SigaMetClasses.Controles.txtNumeroEntero()
        Me.lblBanco = New System.Windows.Forms.Label()
        Me.LabelBase7 = New ControlesBase.LabelBase()
        Me.lblClienteNombre = New System.Windows.Forms.Label()
        Me.LabelBase6 = New ControlesBase.LabelBase()
        Me.lblVigencia = New System.Windows.Forms.Label()
        Me.LabelBase5 = New ControlesBase.LabelBase()
        Me.lblTipoTarjetaCredito = New System.Windows.Forms.Label()
        Me.LabelBase4 = New ControlesBase.LabelBase()
        Me.lblBancoNombre = New System.Windows.Forms.Label()
        Me.LabelBase3 = New ControlesBase.LabelBase()
        Me.lblTarjetaCredito = New System.Windows.Forms.Label()
        Me.LabelBase2 = New ControlesBase.LabelBase()
        Me.LabelBase1 = New ControlesBase.LabelBase()
        Me.Label20 = New ControlesBase.LabelBase()
        Me.lblTitular = New System.Windows.Forms.Label()
        Me.btnBuscarClienteTC = New System.Windows.Forms.Button()
        Me.tbChequeFicha = New System.Windows.Forms.TabPage()
        Me.btnAceptarChequeFicha = New ControlesBase.BotonBase()
        Me.grpChequeFicha = New System.Windows.Forms.GroupBox()
        Me.rbNotaCredito = New System.Windows.Forms.RadioButton()
        Me.lblNombre = New System.Windows.Forms.Label()
        Me.btnBuscarCliente = New System.Windows.Forms.Button()
        Me.txtImporteDocumento = New SigaMetClasses.Controles.txtNumeroDecimal()
        Me.txtClienteCheque = New SigaMetClasses.Controles.txtNumeroEntero()
        Me.txtNumeroCuenta = New SigaMetClasses.Controles.txtNumeroEntero()
        Me.txtDocumento = New SigaMetClasses.Controles.txtNumeroEntero()
        Me.txtObservaciones = New System.Windows.Forms.TextBox()
        Me.ComboBanco = New SigaMetClasses.Combos.ComboBanco()
        Me.Label21 = New ControlesBase.LabelBase()
        Me.lblObservaciones = New ControlesBase.LabelBase()
        Me.dtpFechaCheque = New System.Windows.Forms.DateTimePicker()
        Me.lblNoCheque = New ControlesBase.LabelBase()
        Me.lblFechaCheque = New ControlesBase.LabelBase()
        Me.lblNoCuenta = New ControlesBase.LabelBase()
        Me.lblImporte = New ControlesBase.LabelBase()
        Me.lblCliente = New ControlesBase.LabelBase()
        Me.rbCheque = New System.Windows.Forms.RadioButton()
        Me.rbFicha = New System.Windows.Forms.RadioButton()
        Me.imgLista = New System.Windows.Forms.ImageList(Me.components)
        Me.tabTipoCobro.SuspendLayout()
        Me.tbEfectivoVales.SuspendLayout()
        Me.grpEfectivoVales.SuspendLayout()
        Me.tbTarjetaCredito.SuspendLayout()
        Me.grpTarjetaCredito.SuspendLayout()
        Me.tbChequeFicha.SuspendLayout()
        Me.grpChequeFicha.SuspendLayout()
        Me.SuspendLayout()
        '
        'tabTipoCobro
        '
        Me.tabTipoCobro.Alignment = System.Windows.Forms.TabAlignment.Bottom
        Me.tabTipoCobro.Controls.AddRange(New System.Windows.Forms.Control() {Me.tbEfectivoVales, Me.tbTarjetaCredito, Me.tbChequeFicha})
        Me.tabTipoCobro.Dock = System.Windows.Forms.DockStyle.Fill
        Me.tabTipoCobro.HotTrack = True
        Me.tabTipoCobro.Multiline = True
        Me.tabTipoCobro.Name = "tabTipoCobro"
        Me.tabTipoCobro.SelectedIndex = 0
        Me.tabTipoCobro.Size = New System.Drawing.Size(474, 351)
        Me.tabTipoCobro.TabIndex = 0
        '
        'tbEfectivoVales
        '
        Me.tbEfectivoVales.BackColor = System.Drawing.SystemColors.Control
        Me.tbEfectivoVales.Controls.AddRange(New System.Windows.Forms.Control() {Me.grpEfectivoVales, Me.btnAceptarEfectivoVales})
        Me.tbEfectivoVales.ImageIndex = 0
        Me.tbEfectivoVales.Location = New System.Drawing.Point(4, 4)
        Me.tbEfectivoVales.Name = "tbEfectivoVales"
        Me.tbEfectivoVales.Size = New System.Drawing.Size(466, 325)
        Me.tbEfectivoVales.TabIndex = 3
        Me.tbEfectivoVales.Text = "Efectivo y / o vales"
        '
        'grpEfectivoVales
        '
        Me.grpEfectivoVales.Controls.AddRange(New System.Windows.Forms.Control() {Me.txtTotalEfectivoVales, Me.lblTotalEfectivoVales})
        Me.grpEfectivoVales.Location = New System.Drawing.Point(48, 138)
        Me.grpEfectivoVales.Name = "grpEfectivoVales"
        Me.grpEfectivoVales.Size = New System.Drawing.Size(272, 48)
        Me.grpEfectivoVales.TabIndex = 32
        Me.grpEfectivoVales.TabStop = False
        Me.grpEfectivoVales.Text = "Datos del efectivo o vales de despensa"
        '
        'txtTotalEfectivoVales
        '
        Me.txtTotalEfectivoVales.Location = New System.Drawing.Point(136, 16)
        Me.txtTotalEfectivoVales.Name = "txtTotalEfectivoVales"
        Me.txtTotalEfectivoVales.Size = New System.Drawing.Size(120, 21)
        Me.txtTotalEfectivoVales.TabIndex = 0
        Me.txtTotalEfectivoVales.Text = ""
        '
        'lblTotalEfectivoVales
        '
        Me.lblTotalEfectivoVales.AutoSize = True
        Me.lblTotalEfectivoVales.Location = New System.Drawing.Point(16, 19)
        Me.lblTotalEfectivoVales.Name = "lblTotalEfectivoVales"
        Me.lblTotalEfectivoVales.Size = New System.Drawing.Size(74, 14)
        Me.lblTotalEfectivoVales.TabIndex = 28
        Me.lblTotalEfectivoVales.Text = "Importe total:"
        '
        'btnAceptarEfectivoVales
        '
        Me.btnAceptarEfectivoVales.Anchor = (System.Windows.Forms.AnchorStyles.Top Or System.Windows.Forms.AnchorStyles.Right)
        Me.btnAceptarEfectivoVales.BackColor = System.Drawing.SystemColors.Control
        Me.btnAceptarEfectivoVales.Image = CType(resources.GetObject("btnAceptarEfectivoVales.Image"), System.Drawing.Bitmap)
        Me.btnAceptarEfectivoVales.ImageAlign = System.Drawing.ContentAlignment.MiddleLeft
        Me.btnAceptarEfectivoVales.Location = New System.Drawing.Point(368, 150)
        Me.btnAceptarEfectivoVales.Name = "btnAceptarEfectivoVales"
        Me.btnAceptarEfectivoVales.Size = New System.Drawing.Size(80, 24)
        Me.btnAceptarEfectivoVales.TabIndex = 1
        Me.btnAceptarEfectivoVales.Text = "&Aceptar"
        Me.btnAceptarEfectivoVales.TextAlign = System.Drawing.ContentAlignment.MiddleRight
        '
        'tbTarjetaCredito
        '
        Me.tbTarjetaCredito.Controls.AddRange(New System.Windows.Forms.Control() {Me.btnAceptarTarjetaCredito, Me.grpTarjetaCredito})
        Me.tbTarjetaCredito.Font = New System.Drawing.Font("Tahoma", 8.25!, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, CType(0, Byte))
        Me.tbTarjetaCredito.Location = New System.Drawing.Point(4, 4)
        Me.tbTarjetaCredito.Name = "tbTarjetaCredito"
        Me.tbTarjetaCredito.Size = New System.Drawing.Size(466, 325)
        Me.tbTarjetaCredito.TabIndex = 0
        Me.tbTarjetaCredito.Text = "Tarjeta de crédito"
        '
        'btnAceptarTarjetaCredito
        '
        Me.btnAceptarTarjetaCredito.Anchor = (System.Windows.Forms.AnchorStyles.Top Or System.Windows.Forms.AnchorStyles.Right)
        Me.btnAceptarTarjetaCredito.Image = CType(resources.GetObject("btnAceptarTarjetaCredito.Image"), System.Drawing.Bitmap)
        Me.btnAceptarTarjetaCredito.ImageAlign = System.Drawing.ContentAlignment.MiddleLeft
        Me.btnAceptarTarjetaCredito.Location = New System.Drawing.Point(368, 150)
        Me.btnAceptarTarjetaCredito.Name = "btnAceptarTarjetaCredito"
        Me.btnAceptarTarjetaCredito.Size = New System.Drawing.Size(80, 24)
        Me.btnAceptarTarjetaCredito.TabIndex = 3
        Me.btnAceptarTarjetaCredito.Text = "&Aceptar"
        Me.btnAceptarTarjetaCredito.TextAlign = System.Drawing.ContentAlignment.MiddleRight
        '
        'grpTarjetaCredito
        '
        Me.grpTarjetaCredito.Controls.AddRange(New System.Windows.Forms.Control() {Me.txtImporteTC, Me.txtClienteTC, Me.lblBanco, Me.LabelBase7, Me.lblClienteNombre, Me.LabelBase6, Me.lblVigencia, Me.LabelBase5, Me.lblTipoTarjetaCredito, Me.LabelBase4, Me.lblBancoNombre, Me.LabelBase3, Me.lblTarjetaCredito, Me.LabelBase2, Me.LabelBase1, Me.Label20, Me.lblTitular, Me.btnBuscarClienteTC})
        Me.grpTarjetaCredito.Location = New System.Drawing.Point(48, 36)
        Me.grpTarjetaCredito.Name = "grpTarjetaCredito"
        Me.grpTarjetaCredito.Size = New System.Drawing.Size(280, 253)
        Me.grpTarjetaCredito.TabIndex = 30
        Me.grpTarjetaCredito.TabStop = False
        Me.grpTarjetaCredito.Text = "Datos de la tarjeta de crédito"
        '
        'txtImporteTC
        '
        Me.txtImporteTC.Location = New System.Drawing.Point(104, 216)
        Me.txtImporteTC.Name = "txtImporteTC"
        Me.txtImporteTC.Size = New System.Drawing.Size(160, 21)
        Me.txtImporteTC.TabIndex = 2
        Me.txtImporteTC.Text = ""
        '
        'txtClienteTC
        '
        Me.txtClienteTC.Location = New System.Drawing.Point(104, 32)
        Me.txtClienteTC.Name = "txtClienteTC"
        Me.txtClienteTC.TabIndex = 0
        Me.txtClienteTC.Text = ""
        '
        'lblBanco
        '
        Me.lblBanco.BorderStyle = System.Windows.Forms.BorderStyle.Fixed3D
        Me.lblBanco.Location = New System.Drawing.Point(104, 144)
        Me.lblBanco.Name = "lblBanco"
        Me.lblBanco.Size = New System.Drawing.Size(44, 21)
        Me.lblBanco.TabIndex = 42
        Me.lblBanco.TextAlign = System.Drawing.ContentAlignment.MiddleLeft
        Me.lblBanco.Visible = False
        '
        'LabelBase7
        '
        Me.LabelBase7.AutoSize = True
        Me.LabelBase7.Location = New System.Drawing.Point(16, 65)
        Me.LabelBase7.Name = "LabelBase7"
        Me.LabelBase7.Size = New System.Drawing.Size(48, 14)
        Me.LabelBase7.TabIndex = 40
        Me.LabelBase7.Text = "Nombre:"
        '
        'lblClienteNombre
        '
        Me.lblClienteNombre.BorderStyle = System.Windows.Forms.BorderStyle.Fixed3D
        Me.lblClienteNombre.Location = New System.Drawing.Point(104, 56)
        Me.lblClienteNombre.Name = "lblClienteNombre"
        Me.lblClienteNombre.Size = New System.Drawing.Size(160, 32)
        Me.lblClienteNombre.TabIndex = 41
        Me.lblClienteNombre.TextAlign = System.Drawing.ContentAlignment.MiddleLeft
        '
        'LabelBase6
        '
        Me.LabelBase6.AutoSize = True
        Me.LabelBase6.Location = New System.Drawing.Point(16, 219)
        Me.LabelBase6.Name = "LabelBase6"
        Me.LabelBase6.Size = New System.Drawing.Size(48, 14)
        Me.LabelBase6.TabIndex = 39
        Me.LabelBase6.Text = "Importe:"
        '
        'lblVigencia
        '
        Me.lblVigencia.BorderStyle = System.Windows.Forms.BorderStyle.Fixed3D
        Me.lblVigencia.Location = New System.Drawing.Point(104, 192)
        Me.lblVigencia.Name = "lblVigencia"
        Me.lblVigencia.Size = New System.Drawing.Size(160, 21)
        Me.lblVigencia.TabIndex = 38
        Me.lblVigencia.TextAlign = System.Drawing.ContentAlignment.MiddleLeft
        '
        'LabelBase5
        '
        Me.LabelBase5.AutoSize = True
        Me.LabelBase5.Location = New System.Drawing.Point(16, 195)
        Me.LabelBase5.Name = "LabelBase5"
        Me.LabelBase5.Size = New System.Drawing.Size(50, 14)
        Me.LabelBase5.TabIndex = 37
        Me.LabelBase5.Text = "Vigencia:"
        '
        'lblTipoTarjetaCredito
        '
        Me.lblTipoTarjetaCredito.BorderStyle = System.Windows.Forms.BorderStyle.Fixed3D
        Me.lblTipoTarjetaCredito.Location = New System.Drawing.Point(104, 168)
        Me.lblTipoTarjetaCredito.Name = "lblTipoTarjetaCredito"
        Me.lblTipoTarjetaCredito.Size = New System.Drawing.Size(160, 21)
        Me.lblTipoTarjetaCredito.TabIndex = 36
        Me.lblTipoTarjetaCredito.TextAlign = System.Drawing.ContentAlignment.MiddleLeft
        '
        'LabelBase4
        '
        Me.LabelBase4.AutoSize = True
        Me.LabelBase4.Location = New System.Drawing.Point(16, 171)
        Me.LabelBase4.Name = "LabelBase4"
        Me.LabelBase4.Size = New System.Drawing.Size(82, 14)
        Me.LabelBase4.TabIndex = 35
        Me.LabelBase4.Text = "Tipo de tarjeta:"
        '
        'lblBancoNombre
        '
        Me.lblBancoNombre.BorderStyle = System.Windows.Forms.BorderStyle.Fixed3D
        Me.lblBancoNombre.Location = New System.Drawing.Point(104, 144)
        Me.lblBancoNombre.Name = "lblBancoNombre"
        Me.lblBancoNombre.Size = New System.Drawing.Size(160, 21)
        Me.lblBancoNombre.TabIndex = 34
        Me.lblBancoNombre.TextAlign = System.Drawing.ContentAlignment.MiddleLeft
        '
        'LabelBase3
        '
        Me.LabelBase3.AutoSize = True
        Me.LabelBase3.Location = New System.Drawing.Point(16, 147)
        Me.LabelBase3.Name = "LabelBase3"
        Me.LabelBase3.Size = New System.Drawing.Size(38, 14)
        Me.LabelBase3.TabIndex = 33
        Me.LabelBase3.Text = "Banco:"
        '
        'lblTarjetaCredito
        '
        Me.lblTarjetaCredito.BorderStyle = System.Windows.Forms.BorderStyle.Fixed3D
        Me.lblTarjetaCredito.Location = New System.Drawing.Point(104, 120)
        Me.lblTarjetaCredito.Name = "lblTarjetaCredito"
        Me.lblTarjetaCredito.Size = New System.Drawing.Size(160, 21)
        Me.lblTarjetaCredito.TabIndex = 32
        Me.lblTarjetaCredito.TextAlign = System.Drawing.ContentAlignment.MiddleLeft
        '
        'LabelBase2
        '
        Me.LabelBase2.AutoSize = True
        Me.LabelBase2.Location = New System.Drawing.Point(16, 123)
        Me.LabelBase2.Name = "LabelBase2"
        Me.LabelBase2.Size = New System.Drawing.Size(64, 14)
        Me.LabelBase2.TabIndex = 26
        Me.LabelBase2.Text = "No. Tarjeta:"
        '
        'LabelBase1
        '
        Me.LabelBase1.AutoSize = True
        Me.LabelBase1.Location = New System.Drawing.Point(16, 99)
        Me.LabelBase1.Name = "LabelBase1"
        Me.LabelBase1.Size = New System.Drawing.Size(40, 14)
        Me.LabelBase1.TabIndex = 24
        Me.LabelBase1.Text = "Titular:"
        '
        'Label20
        '
        Me.Label20.AutoSize = True
        Me.Label20.Location = New System.Drawing.Point(16, 35)
        Me.Label20.Name = "Label20"
        Me.Label20.Size = New System.Drawing.Size(42, 14)
        Me.Label20.TabIndex = 22
        Me.Label20.Text = "Cliente:"
        '
        'lblTitular
        '
        Me.lblTitular.BorderStyle = System.Windows.Forms.BorderStyle.Fixed3D
        Me.lblTitular.Location = New System.Drawing.Point(104, 96)
        Me.lblTitular.Name = "lblTitular"
        Me.lblTitular.Size = New System.Drawing.Size(160, 21)
        Me.lblTitular.TabIndex = 31
        Me.lblTitular.TextAlign = System.Drawing.ContentAlignment.MiddleLeft
        '
        'btnBuscarClienteTC
        '
        Me.btnBuscarClienteTC.Image = CType(resources.GetObject("btnBuscarClienteTC.Image"), System.Drawing.Bitmap)
        Me.btnBuscarClienteTC.Location = New System.Drawing.Point(216, 32)
        Me.btnBuscarClienteTC.Name = "btnBuscarClienteTC"
        Me.btnBuscarClienteTC.Size = New System.Drawing.Size(48, 21)
        Me.btnBuscarClienteTC.TabIndex = 1
        '
        'tbChequeFicha
        '
        Me.tbChequeFicha.Controls.AddRange(New System.Windows.Forms.Control() {Me.btnAceptarChequeFicha, Me.grpChequeFicha})
        Me.tbChequeFicha.Location = New System.Drawing.Point(4, 4)
        Me.tbChequeFicha.Name = "tbChequeFicha"
        Me.tbChequeFicha.Size = New System.Drawing.Size(466, 325)
        Me.tbChequeFicha.TabIndex = 2
        Me.tbChequeFicha.Text = "Cheque / Ficha de deposito"
        '
        'btnAceptarChequeFicha
        '
        Me.btnAceptarChequeFicha.Anchor = (System.Windows.Forms.AnchorStyles.Top Or System.Windows.Forms.AnchorStyles.Right)
        Me.btnAceptarChequeFicha.Image = CType(resources.GetObject("btnAceptarChequeFicha.Image"), System.Drawing.Bitmap)
        Me.btnAceptarChequeFicha.ImageAlign = System.Drawing.ContentAlignment.MiddleLeft
        Me.btnAceptarChequeFicha.Location = New System.Drawing.Point(368, 150)
        Me.btnAceptarChequeFicha.Name = "btnAceptarChequeFicha"
        Me.btnAceptarChequeFicha.Size = New System.Drawing.Size(80, 24)
        Me.btnAceptarChequeFicha.TabIndex = 7
        Me.btnAceptarChequeFicha.Text = "&Aceptar"
        Me.btnAceptarChequeFicha.TextAlign = System.Drawing.ContentAlignment.MiddleRight
        '
        'grpChequeFicha
        '
        Me.grpChequeFicha.Controls.AddRange(New System.Windows.Forms.Control() {Me.rbNotaCredito, Me.lblNombre, Me.btnBuscarCliente, Me.txtImporteDocumento, Me.txtClienteCheque, Me.txtNumeroCuenta, Me.txtDocumento, Me.txtObservaciones, Me.ComboBanco, Me.Label21, Me.lblObservaciones, Me.dtpFechaCheque, Me.lblNoCheque, Me.lblFechaCheque, Me.lblNoCuenta, Me.lblImporte, Me.lblCliente, Me.rbCheque, Me.rbFicha})
        Me.grpChequeFicha.Location = New System.Drawing.Point(24, 27)
        Me.grpChequeFicha.Name = "grpChequeFicha"
        Me.grpChequeFicha.Size = New System.Drawing.Size(328, 270)
        Me.grpChequeFicha.TabIndex = 28
        Me.grpChequeFicha.TabStop = False
        '
        'rbNotaCredito
        '
        Me.rbNotaCredito.Location = New System.Drawing.Point(208, 0)
        Me.rbNotaCredito.Name = "rbNotaCredito"
        Me.rbNotaCredito.Size = New System.Drawing.Size(104, 16)
        Me.rbNotaCredito.TabIndex = 35
        Me.rbNotaCredito.Text = "&Nota de crédito"
        '
        'lblNombre
        '
        Me.lblNombre.BorderStyle = System.Windows.Forms.BorderStyle.Fixed3D
        Me.lblNombre.Location = New System.Drawing.Point(120, 128)
        Me.lblNombre.Name = "lblNombre"
        Me.lblNombre.Size = New System.Drawing.Size(192, 21)
        Me.lblNombre.TabIndex = 34
        Me.lblNombre.TextAlign = System.Drawing.ContentAlignment.MiddleLeft
        '
        'btnBuscarCliente
        '
        Me.btnBuscarCliente.Image = CType(resources.GetObject("btnBuscarCliente.Image"), System.Drawing.Bitmap)
        Me.btnBuscarCliente.Location = New System.Drawing.Point(264, 104)
        Me.btnBuscarCliente.Name = "btnBuscarCliente"
        Me.btnBuscarCliente.Size = New System.Drawing.Size(48, 21)
        Me.btnBuscarCliente.TabIndex = 31
        '
        'txtImporteDocumento
        '
        Me.txtImporteDocumento.Location = New System.Drawing.Point(120, 176)
        Me.txtImporteDocumento.Name = "txtImporteDocumento"
        Me.txtImporteDocumento.Size = New System.Drawing.Size(192, 21)
        Me.txtImporteDocumento.TabIndex = 5
        Me.txtImporteDocumento.Text = ""
        '
        'txtClienteCheque
        '
        Me.txtClienteCheque.Location = New System.Drawing.Point(120, 104)
        Me.txtClienteCheque.Name = "txtClienteCheque"
        Me.txtClienteCheque.Size = New System.Drawing.Size(88, 21)
        Me.txtClienteCheque.TabIndex = 3
        Me.txtClienteCheque.Text = ""
        '
        'txtNumeroCuenta
        '
        Me.txtNumeroCuenta.Location = New System.Drawing.Point(120, 80)
        Me.txtNumeroCuenta.Name = "txtNumeroCuenta"
        Me.txtNumeroCuenta.Size = New System.Drawing.Size(192, 21)
        Me.txtNumeroCuenta.TabIndex = 2
        Me.txtNumeroCuenta.Text = ""
        '
        'txtDocumento
        '
        Me.txtDocumento.Location = New System.Drawing.Point(120, 32)
        Me.txtDocumento.MaxLength = 7
        Me.txtDocumento.Name = "txtDocumento"
        Me.txtDocumento.Size = New System.Drawing.Size(192, 21)
        Me.txtDocumento.TabIndex = 0
        Me.txtDocumento.Text = ""
        '
        'txtObservaciones
        '
        Me.txtObservaciones.AutoSize = False
        Me.txtObservaciones.Location = New System.Drawing.Point(120, 200)
        Me.txtObservaciones.Multiline = True
        Me.txtObservaciones.Name = "txtObservaciones"
        Me.txtObservaciones.Size = New System.Drawing.Size(192, 48)
        Me.txtObservaciones.TabIndex = 6
        Me.txtObservaciones.Text = ""
        '
        'ComboBanco
        '
        Me.ComboBanco.DropDownStyle = System.Windows.Forms.ComboBoxStyle.DropDownList
        Me.ComboBanco.DropDownWidth = 200
        Me.ComboBanco.Location = New System.Drawing.Point(120, 152)
        Me.ComboBanco.Name = "ComboBanco"
        Me.ComboBanco.Size = New System.Drawing.Size(192, 21)
        Me.ComboBanco.TabIndex = 4
        '
        'Label21
        '
        Me.Label21.AutoSize = True
        Me.Label21.Location = New System.Drawing.Point(16, 155)
        Me.Label21.Name = "Label21"
        Me.Label21.Size = New System.Drawing.Size(38, 14)
        Me.Label21.TabIndex = 15
        Me.Label21.Text = "Banco:"
        '
        'lblObservaciones
        '
        Me.lblObservaciones.AutoSize = True
        Me.lblObservaciones.Location = New System.Drawing.Point(16, 200)
        Me.lblObservaciones.Name = "lblObservaciones"
        Me.lblObservaciones.Size = New System.Drawing.Size(80, 14)
        Me.lblObservaciones.TabIndex = 21
        Me.lblObservaciones.Text = "Observaciones:"
        '
        'dtpFechaCheque
        '
        Me.dtpFechaCheque.Format = System.Windows.Forms.DateTimePickerFormat.Short
        Me.dtpFechaCheque.Location = New System.Drawing.Point(120, 56)
        Me.dtpFechaCheque.Name = "dtpFechaCheque"
        Me.dtpFechaCheque.Size = New System.Drawing.Size(192, 21)
        Me.dtpFechaCheque.TabIndex = 1
        '
        'lblNoCheque
        '
        Me.lblNoCheque.AutoSize = True
        Me.lblNoCheque.Location = New System.Drawing.Point(16, 35)
        Me.lblNoCheque.Name = "lblNoCheque"
        Me.lblNoCheque.Size = New System.Drawing.Size(86, 14)
        Me.lblNoCheque.TabIndex = 11
        Me.lblNoCheque.Text = "No. Documento:"
        '
        'lblFechaCheque
        '
        Me.lblFechaCheque.AutoSize = True
        Me.lblFechaCheque.Location = New System.Drawing.Point(16, 59)
        Me.lblFechaCheque.Name = "lblFechaCheque"
        Me.lblFechaCheque.Size = New System.Drawing.Size(97, 14)
        Me.lblFechaCheque.TabIndex = 16
        Me.lblFechaCheque.Text = "Fecha documento:"
        '
        'lblNoCuenta
        '
        Me.lblNoCuenta.AutoSize = True
        Me.lblNoCuenta.Location = New System.Drawing.Point(16, 83)
        Me.lblNoCuenta.Name = "lblNoCuenta"
        Me.lblNoCuenta.Size = New System.Drawing.Size(64, 14)
        Me.lblNoCuenta.TabIndex = 12
        Me.lblNoCuenta.Text = "No. Cuenta:"
        '
        'lblImporte
        '
        Me.lblImporte.AutoSize = True
        Me.lblImporte.Location = New System.Drawing.Point(16, 179)
        Me.lblImporte.Name = "lblImporte"
        Me.lblImporte.Size = New System.Drawing.Size(48, 14)
        Me.lblImporte.TabIndex = 19
        Me.lblImporte.Text = "Importe:"
        '
        'lblCliente
        '
        Me.lblCliente.AutoSize = True
        Me.lblCliente.Location = New System.Drawing.Point(16, 107)
        Me.lblCliente.Name = "lblCliente"
        Me.lblCliente.Size = New System.Drawing.Size(42, 14)
        Me.lblCliente.TabIndex = 13
        Me.lblCliente.Text = "Cliente:"
        '
        'rbCheque
        '
        Me.rbCheque.Checked = True
        Me.rbCheque.Location = New System.Drawing.Point(16, 0)
        Me.rbCheque.Name = "rbCheque"
        Me.rbCheque.Size = New System.Drawing.Size(64, 16)
        Me.rbCheque.TabIndex = 29
        Me.rbCheque.TabStop = True
        Me.rbCheque.Text = "&Cheque"
        '
        'rbFicha
        '
        Me.rbFicha.Location = New System.Drawing.Point(88, 0)
        Me.rbFicha.Name = "rbFicha"
        Me.rbFicha.Size = New System.Drawing.Size(112, 16)
        Me.rbFicha.TabIndex = 30
        Me.rbFicha.Text = "&Ficha de depósito"
        '
        'imgLista
        '
        Me.imgLista.ColorDepth = System.Windows.Forms.ColorDepth.Depth8Bit
        Me.imgLista.ImageSize = New System.Drawing.Size(16, 16)
        Me.imgLista.TransparentColor = System.Drawing.Color.Transparent
        '
        'frmSelTipoCobro
        '
        Me.AcceptButton = Me.btnAceptarEfectivoVales
        Me.AutoScaleBaseSize = New System.Drawing.Size(5, 14)
        Me.ClientSize = New System.Drawing.Size(474, 351)
        Me.Controls.AddRange(New System.Windows.Forms.Control() {Me.tabTipoCobro})
        Me.Font = New System.Drawing.Font("Tahoma", 8.25!, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, CType(0, Byte))
        Me.FormBorderStyle = System.Windows.Forms.FormBorderStyle.FixedDialog
        Me.MaximizeBox = False
        Me.MinimizeBox = False
        Me.Name = "frmSelTipoCobro"
        Me.StartPosition = System.Windows.Forms.FormStartPosition.CenterScreen
        Me.Text = "Captura de cobros"
        Me.tabTipoCobro.ResumeLayout(False)
        Me.tbEfectivoVales.ResumeLayout(False)
        Me.grpEfectivoVales.ResumeLayout(False)
        Me.tbTarjetaCredito.ResumeLayout(False)
        Me.grpTarjetaCredito.ResumeLayout(False)
        Me.tbChequeFicha.ResumeLayout(False)
        Me.grpChequeFicha.ResumeLayout(False)
        Me.ResumeLayout(False)

    End Sub

#End Region

#Region "Cobros"

    'EFECTIVO Y / O VALES
    Private Sub btnAceptarEfectivoVales_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnAceptarEfectivoVales.Click
        If CapturaEfectivoVales = False Then
            If txtTotalEfectivoVales.Text <> "" And IsNumeric(txtTotalEfectivoVales.Text) Then
                If _CapturaDetalle = True Then
                    Dim frmCaptura As New frmCapCobranzaDoc()
                    frmCaptura.TipoCobro = SigaMetClasses.Enumeradores.enumTipoCobro.EfectivoVales
                    frmCaptura.ImporteCobro = CType(txtTotalEfectivoVales.Text, Decimal)

                    If frmCaptura.ShowDialog = DialogResult.OK Then
                        With Cobro
                            .Consecutivo = Consecutivo
                            .AnoCobro = CType(Year(Today), Short)
                            .TipoCobro = SigaMetClasses.Enumeradores.enumTipoCobro.EfectivoVales
                            .Total = CType(txtTotalEfectivoVales.Text, Decimal)
                            .ListaPedidos = frmCaptura.ListaCobroPedido
                            ImporteTotalCobro = .Total
                        End With
                    End If
                Else
                    With Cobro
                        .Consecutivo = Consecutivo
                        .AnoCobro = CType(Year(Today), Short)
                        .TipoCobro = SigaMetClasses.Enumeradores.enumTipoCobro.EfectivoVales
                        .Total = CType(txtTotalEfectivoVales.Text, Decimal)
                        .ListaPedidos = Nothing
                        ImporteTotalCobro = .Total
                    End With
                End If
                DialogResult = DialogResult.OK

            End If
        Else
            MessageBox.Show("Ya capturó efectivo o vales")
        End If
    End Sub

    'TARJETA DE CREDITO
    Private Sub btnAceptarTarjetaCredito_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnAceptarTarjetaCredito.Click
        If lblClienteNombre.Text <> "" Then
            If txtImporteTC.Text <> "" And IsNumeric(txtImporteTC.Text) Then
                If _CapturaDetalle = True Then
                    Dim frmCaptura As New frmCapCobranzaDoc()
                    frmCaptura.TipoCobro = SigaMetClasses.Enumeradores.enumTipoCobro.TarjetaCredito
                    frmCaptura.ImporteCobro = CType(txtImporteTC.Text, Decimal)

                    If frmCaptura.ShowDialog = DialogResult.OK Then
                        With Cobro
                            .Consecutivo = Consecutivo
                            .AnoCobro = CType(Year(Today), Short)
                            .TipoCobro = SigaMetClasses.Enumeradores.enumTipoCobro.TarjetaCredito
                            .Total = CType(txtImporteTC.Text, Decimal)
                            .Cliente = CType(txtClienteTC.Text, Integer)
                            .Banco = CType(lblBanco.Text, Short)
                            .NoCuenta = lblTarjetaCredito.Text
                            .ListaPedidos = frmCaptura.ListaCobroPedido
                            ImporteTotalCobro = .Total
                        End With
                    End If
                Else
                    With Cobro
                        .Consecutivo = Consecutivo
                        .AnoCobro = CType(Year(Today), Short)
                        .TipoCobro = SigaMetClasses.Enumeradores.enumTipoCobro.TarjetaCredito
                        .Total = CType(txtImporteTC.Text, Decimal)
                        .Cliente = CType(txtClienteTC.Text, Integer)
                        .Banco = CType(lblBanco.Text, Short)
                        .NoCuenta = lblTarjetaCredito.Text
                        .ListaPedidos = Nothing
                        ImporteTotalCobro = .Total
                    End With
                End If
                DialogResult = DialogResult.OK
            Else
                MessageBox.Show("Debe teclear el importe del cobro.", Titulo, MessageBoxButtons.OK, MessageBoxIcon.Exclamation)
            End If
        Else
            MessageBox.Show("Debe teclear el número de cliente.", Titulo, MessageBoxButtons.OK, MessageBoxIcon.Exclamation)
        End If
    End Sub



    'CHEQUE Y FICHA DE DEPOSITO
    Private Sub btnAceptarChequeFicha_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnAceptarChequeFicha.Click
        If ValidaCapturaChequeFicha() Then
            If _CapturaDetalle = True Then
                Dim frmCaptura As New frmCapCobranzaDoc()
                frmCaptura.TipoCobro = _TipoCobro
                frmCaptura.ImporteCobro = CType(txtImporteDocumento.Text, Decimal)
                If frmCaptura.ShowDialog() = DialogResult.OK Then
                    With Cobro
                        .Consecutivo = Consecutivo
                        .AnoCobro = CType(Year(Today), Short)
                        .TipoCobro = _TipoCobro
                        .Total = CType(txtImporteDocumento.Text, Decimal)
                        .NoCheque = Trim(txtDocumento.Text)
                        .FechaCheque = CType(dtpFechaCheque.Value.ToShortDateString, Date)
                        .NoCuenta = Trim(txtNumeroCuenta.Text)
                        .Cliente = CType(txtClienteCheque.Text, Integer)
                        .Banco = CType(ComboBanco.SelectedValue, Short)
                        .Observaciones = Trim(txtObservaciones.Text)
                        .ListaPedidos = frmCaptura.ListaCobroPedido
                        ImporteTotalCobro = .Total
                    End With
                End If
            Else
                With Cobro
                    .Consecutivo = Consecutivo
                    .AnoCobro = CType(Year(Today), Short)
                    .TipoCobro = _TipoCobro
                    .Total = CType(txtImporteDocumento.Text, Decimal)
                    .NoCheque = Trim(txtDocumento.Text)
                    .FechaCheque = CType(dtpFechaCheque.Value.ToShortDateString, Date)
                    .NoCuenta = Trim(txtNumeroCuenta.Text)
                    .Cliente = CType(txtClienteCheque.Text, Integer)
                    .Banco = CType(ComboBanco.SelectedValue, Short)
                    .Observaciones = Trim(txtObservaciones.Text)
                    .ListaPedidos = Nothing
                    ImporteTotalCobro = .Total
                End With
            End If
            DialogResult = DialogResult.OK
        End If
    End Sub

#End Region



    Private Function ValidaCapturaChequeFicha() As Boolean
        'Con esta función valido que se estén capturando todos los datos necesarios
        'del cheque ó de la ficha de depósito.
        If txtImporteDocumento.Text <> "" And IsNumeric(txtImporteDocumento.Text) Then
            If txtDocumento.Text <> "" And IsNumeric(txtDocumento.Text) Then
                If txtDocumento.Text.Trim.Length = 7 Then
                    If txtNumeroCuenta.Text <> "" And IsNumeric(txtNumeroCuenta.Text) Then
                        If txtClienteCheque.Text <> "" And IsNumeric(txtClienteCheque.Text) And lblNombre.Text <> "" Then
                            If CType(ComboBanco.SelectedValue, Short) > 0 Then
                                Return True
                            Else
                                MessageBox.Show("Debe seleccionar el banco.", Titulo, MessageBoxButtons.OK, MessageBoxIcon.Exclamation)
                                Return False
                            End If
                        Else
                            MessageBox.Show("Debe teclear el número de un cliente válido.", Titulo, MessageBoxButtons.OK, MessageBoxIcon.Exclamation)
                            Return False
                        End If
                    Else
                        MessageBox.Show("Debe teclear el número de cuenta.", Titulo, MessageBoxButtons.OK, MessageBoxIcon.Exclamation)
                        Return False
                    End If
                Else
                    MessageBox.Show("El número de cheque debe ser de 7 dígitos.", Titulo, MessageBoxButtons.OK, MessageBoxIcon.Exclamation)
                    txtDocumento.Focus()
                    txtDocumento.SelectAll()
                    Return False
                End If
            Else
                MessageBox.Show("Debe teclear el número del cheque.", Titulo, MessageBoxButtons.OK, MessageBoxIcon.Exclamation)
                Return False
            End If
        Else
            MessageBox.Show("Debe teclear el importe del cheque.", Titulo, MessageBoxButtons.OK, MessageBoxIcon.Exclamation)
            Return False
        End If
    End Function

    Private Sub tabTipoCobro_SelectedIndexChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles tabTipoCobro.SelectedIndexChanged
        Select Case tabTipoCobro.SelectedTab.Name
            Case Is = "tbEfectivoVales"
                AcceptButton = btnAceptarEfectivoVales
                txtTotalEfectivoVales.Focus()
            Case Is = "tbChequeFicha"
                AcceptButton = btnAceptarChequeFicha
                txtDocumento.Focus()
            Case Is = "tbTarjetaCredito"
                AcceptButton = btnAceptarTarjetaCredito
                txtClienteTC.Focus()
        End Select
    End Sub

    Private Sub frmSelTipoCobro_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles MyBase.Load
        ComboBanco.CargaDatos(True)

        If CapturaEfectivoVales = True Then
            btnAceptarEfectivoVales.Enabled = False
            tabTipoCobro.SelectedTab = tbChequeFicha
        End If
        AddHandler txtImporteTC.KeyDown, AddressOf ManejaFlechas
    End Sub

    Private Sub txtClienteTC_Enter(ByVal sender As System.Object, ByVal e As System.EventArgs)
        AcceptButton = btnBuscarClienteTC
    End Sub

    Private Sub txtClienteTC_Leave(ByVal sender As System.Object, ByVal e As System.EventArgs)
        AcceptButton = btnAceptarTarjetaCredito
    End Sub

    Private Sub LimpiaInfoTarjetaCredito()
        lblClienteNombre.Text = ""
        lblTitular.Text = ""
        lblTarjetaCredito.Text = ""
        lblBancoNombre.Text = ""
        lblTipoTarjetaCredito.Text = ""
        lblVigencia.Text = ""
    End Sub

    Private Sub ConsultaTarjetaCredito(ByVal Cliente As Integer)
        Dim oTC As New SigaMetClasses.cTarjetaCredito()
        Dim dr As SqlDataReader
        dr = oTC.ConsultaActiva(Cliente)
        Do While dr.Read
            lblClienteNombre.Text = CType(dr("ClienteNombre"), String)
            lblTitular.Text = CType(dr("Titular"), String)
            lblTarjetaCredito.Text = CType(dr("TarjetaCredito"), String)
            lblBanco.Text = CType(dr("Banco"), String)
            lblBancoNombre.Text = CType(dr("BancoNombre"), String)
            lblTipoTarjetaCredito.Text = CType(dr("TipoTarjetaCreditoDescripcion"), String)
            lblVigencia.Text = CType(dr("MesVigencia"), String) & " / " & CType(dr("AñoVigencia"), String)
        Loop
        dr.Close()
    End Sub

    Private Sub btnBuscarClienteTC_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnBuscarClienteTC.Click
        If txtClienteTC.Text <> "" And IsNumeric(txtClienteTC.Text) Then
            LimpiaInfoTarjetaCredito()
            ConsultaTarjetaCredito(CType(txtClienteTC.Text, Integer))
            If lblTarjetaCredito.Text = "" Then
                MessageBox.Show("No existen tarjetas de crédito del cliente especificado.", Titulo, MessageBoxButtons.OK, MessageBoxIcon.Exclamation)
            Else
                txtImporteTC.Focus()
            End If
        End If
    End Sub

    Private Sub ManejaFlechas(ByVal sender As System.Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles dtpFechaCheque.KeyDown, MyBase.KeyDown
        If e.KeyCode = Keys.F5 Then
            tabTipoCobro.SelectedTab = tbEfectivoVales
            Exit Sub
        End If
        If e.KeyCode = Keys.F6 Then
            tabTipoCobro.SelectedTab = tbChequeFicha
            Exit Sub
        End If
        If e.KeyCode = Keys.F7 Then
            tabTipoCobro.SelectedTab = tbTarjetaCredito
        End If
        If e.KeyCode = Keys.Down Then
            SendKeys.Send("{TAB}")
        End If
        If e.KeyCode = Keys.Left Or e.KeyCode = Keys.Right Then
            Select Case tabTipoCobro.SelectedTab.Name
                Case Is = "tbEfectivoVales"
                    If e.KeyCode = Keys.Right Then tabTipoCobro.SelectedTab = tbChequeFicha
                    If e.KeyCode = Keys.Left Then tabTipoCobro.SelectedTab = tbTarjetaCredito
                Case Is = "tbCheque"
                    If e.KeyCode = Keys.Right Then tabTipoCobro.SelectedTab = tbTarjetaCredito
                    If e.KeyCode = Keys.Left Then tabTipoCobro.SelectedTab = tbEfectivoVales
                Case Is = "tbTarjetaCredito"
                    If e.KeyCode = Keys.Right Then tabTipoCobro.SelectedTab = tbEfectivoVales
                    If e.KeyCode = Keys.Left Then tabTipoCobro.SelectedTab = tbChequeFicha
            End Select
        End If
    End Sub

    Private Sub rbCheque_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles rbCheque.CheckedChanged
        _TipoCobro = SigaMetClasses.Enumeradores.enumTipoCobro.Cheque
    End Sub

    Private Sub rbFicha_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles rbFicha.CheckedChanged
        _TipoCobro = SigaMetClasses.Enumeradores.enumTipoCobro.FichaDeposito
    End Sub

    Private Sub btnBuscarCliente_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnBuscarCliente.Click
        If Trim(txtClienteCheque.Text) <> "" Then
            Dim frmConCliente As New SigaMetClasses.frmConsultaCliente(CType(txtClienteCheque.Text, Integer))
            frmConCliente.ShowDialog()
        End If
    End Sub

    Private Sub txtClienteCheque_Leave(ByVal sender As Object, ByVal e As System.EventArgs) Handles txtClienteCheque.Leave
        Dim oCliente As New SigaMetClasses.cCliente()
        oCliente.Consulta(CType(txtClienteCheque.Text, Integer))
        lblNombre.Text = oCliente.Nombre
        oCliente = Nothing
    End Sub

<<<<<<< HEAD
End Class
=======
    Private Sub TxtClienteAplicAntic_Leave(sender As Object, e As EventArgs) Handles TxtClienteAplicAntic.Leave
        Dim oCliente As New SigaMetClasses.cCliente()
        If TxtClienteAplicAntic.Text.Trim.Length <> 0 Then
            oCliente.Consulta(CType(TxtClienteAplicAntic.Text, Integer))
            LabelNombreApAntic.Text = oCliente.Nombre
            oCliente = Nothing
        End If
        BuscarAnticipos(CType(TxtClienteAplicAntic.Text, Integer), "0", 0, 0)
    End Sub

    Public Sub Remisiones(UltimoCobro As SigaMetClasses.CobroDetalladoDatos, AceptaSaldo As Boolean, tipocobro As Integer)
        Dim frmRemisiones As New frmRemisiones(Total)
        Dim insertaCobro As New SigaMetClasses.CobroDetalladoDatos()
        frmRemisiones.ObtenerRemisiones = _TablaRemisiones
        frmRemisiones.UltimoCobro = UltimoCobro
        frmRemisiones.AceptaSaldo = AceptaSaldo
        frmRemisiones.TipoCobro = tipocobro
		frmRemisiones.Pago = Pago

		If frmRemisiones.ShowDialog() = DialogResult.OK Then
            Cursor = Cursors.WaitCursor
            Cursor = Cursors.Default
        Else
            _TablaRemisiones = frmRemisiones.ObtenerRemisiones
            CobroRemisiones = frmRemisiones.CobroRemisiones
            insertaCobro = frmRemisiones.UltimoCobro
            Dim cancelar As Boolean = frmRemisiones.CancelarFormaPago
            If cancelar = False Then
                _listaCobros.Add(insertaCobro)
            Else
                _Remisiones = True
            End If


        End If
    End Sub



    Public Function AltaVales(Pago As Integer) As SigaMetClasses.CobroDetalladoDatos
        Dim insertaCobro As New SigaMetClasses.CobroDetalladoDatos()

        With insertaCobro
            .Pago = Pago
            .TPV = False
            .SaldoAFavor = False
            .AñoCobro = CShort(DateTime.Now.Year)
            .Cobro = 0
            .Cliente = CInt(txtClienteVales.Text)
            .FCheque = CDate(FechaDocumentoVales.Text)
            .NumeroCuenta = "NULL"
            .Banco = CShort(ComboProveedor.SelectedValue)
            .Observaciones = TextObservacionesVales.Text
            .TipoCobro = CByte(SigaMetClasses.Enumeradores.enumTipoCobro.Vales)
            .DscTipoCobro = "Vale"
            .FAlta = CDate(DateTime.Now.ToString("dd/MM/yyyy"))
            .Status = "EMITIDO"
            .Usuario = GLOBAL_IDUsuario
            .Total = CDec(TxtMontoVales.Text)
            .Importe = .Total / CDec(1 + (GLOBAL_IVA / 100))
            .Impuesto = .Total - .Importe
            .Referencia = "NULL" ' puede ser vacio
            .NumeroCheque = "NULL" ' puede ser vacio
            .FDevolucion = Date.MinValue
            .RazonDevCheque = Nothing
            .Saldo = 10 ' el saldo se regresa conforme termine las remisiones
            .FActualizacion = Date.MinValue
            .Folio = _FolioCobro
            .FDeposito = Date.MinValue
            .FolioAtt = _FolioCobro
            .AñoAtt = CShort(_FechaCargo.Year)
            .NumeroCuentaDestino = "NULL"
            .BancoOrigen = CShort("0")
            .StatusSaldoAFavor = "NULL"
            .AñoCobroOrigen = CShort("0")
            .CobroOrigen = 0
        End With
        '_listaCobros.Add(insertaCobro)
        Return insertaCobro
    End Function

    Public Function AltaAnticipo(Pago As Integer) As SigaMetClasses.CobroDetalladoDatos
        Dim insertaCobro As New SigaMetClasses.CobroDetalladoDatos()
        With insertaCobro
            .Pago = Pago
            .TPV = True
            .SaldoAFavor = False
            .AñoCobro = CShort(DateTime.Now.Year)
            .Cobro = 0
            .Cliente = CInt(TxtClienteAplicAntic.Text)
            .FCheque = CDate(DateTime.Now.ToString("dd/MM/yyyy"))
            .NumeroCuenta = "NULL"
            .Banco = CShort(ComboProveedor.SelectedValue)
            .Observaciones = TextObservacionesAnticipo.Text
            .TipoCobro = CByte(SigaMetClasses.Enumeradores.enumTipoCobro.AplicacionAnticipo)
            .DscTipoCobro = "Aplicación de anticipo"
            .FAlta = CDate(DateTime.Now.ToString("dd/MM/yyyy"))
            .Status = "EMITIDO"
            .Usuario = GLOBAL_IDUsuario
            .Total = CDec(TxtMontoAnticipo.Text)
            .Importe = .Total / CDec(1 + (GLOBAL_IVA / 100))
            .Impuesto = .Total - .Importe
            .Referencia = "NULL" ' puede ser vacio
            .NumeroCheque = "NULL" ' puede ser vacio
            .FDevolucion = CDate(DateTime.Now.ToString("dd/MM/yyyy"))
            .RazonDevCheque = Nothing
            .Saldo = 0
            .FActualizacion = CDate(DateTime.Now.ToString("dd/MM/yyyy"))
            .Folio = 0
            .FDeposito = CDate(DateTime.Now.ToString("dd/MM/yyyy"))
            .FolioAtt = _FolioCobro
            .AñoAtt = CShort(_FechaCargo.Year)
            .NumeroCuentaDestino = "NULL"
            .BancoOrigen = CShort("0")
            .StatusSaldoAFavor = "NULL"
            .AñoCobroOrigen = CShort("0")
            .CobroOrigen = 0
        End With
        '_listaCobros.Add(insertaCobro)
        Return insertaCobro

    End Function


    Private Sub btn_AnticipoAceptar_Click(sender As Object, e As EventArgs) Handles btn_AnticipoAceptar.Click
        Dim visibleSelectedRowCount As Boolean = False
        Dim Año As String = ""
        Dim Folio As String = ""
        Dim Saldo As Decimal = 0
        Dim Col As Integer = 0

        Try
            If Me.dgvSaldoAnticipo.Rows.Count > 0 Then
                Col = Me.dgvSaldoAnticipo.CurrentCell.ColumnIndex
            Else
                Throw New Exception("El cliente no tiene anticipos, la operación solicitada no es válida.")
            End If

            For Each fila As DataGridViewRow In Me.dgvSaldoAnticipo.Rows
                If fila.Selected Then
                    Año = Convert.ToString(fila.Cells(0).Value)
                    Folio = Convert.ToString(fila.Cells(1).Value)
                    Saldo = Convert.ToDecimal(fila.Cells(2).Value)
                    visibleSelectedRowCount = True
                End If
            Next

            If visibleSelectedRowCount = True And TxtMontoAnticipo.Text.Trim <> "" Then
                If Saldo >= Convert.ToDecimal(TxtMontoAnticipo.Text) Then
                    Total = CDec(TxtMontoAnticipo.Text)

                    Pago = TotalCobros + 1
                    TipoCobro = SigaMetClasses.Enumeradores.enumTipoCobro.AplicacionAnticipo
                    Dim cobro As SigaMetClasses.CobroDetalladoDatos = AltaAnticipo(Pago)
                    Dim listaDebito As New List(Of DebitoAnticipo)
                    Dim nuevodebitoanticipo As New DebitoAnticipo
                    nuevodebitoanticipo.folio = Folio
                    nuevodebitoanticipo.anio = Año
                    nuevodebitoanticipo.montodebitado = Convert.ToDecimal(TxtMontoAnticipo.Text)
                    listaDebito.Add(nuevodebitoanticipo)
                    _ListaDebitoAnticipos.Add(nuevodebitoanticipo)
                    ActualizarSaldoAnticipo(DirectCast(dgvSaldoAnticipo.DataSource, DataTable), AgruparDebitoAnticipo(_ListaDebitoAnticipos))
                    _AceptaSaldo = True
                    If _CapturaDetalle = True Then
                        Remisiones(cobro, _AceptaSaldo, TipoCobro)
                    Else
                        _listaCobros.Clear()
                        _listaCobros.Add(cobro)
                    End If

                    LimpiarAnticipo()
                    _ImporteTotalCobro = Total
                    Total = 0
                    DialogResult = DialogResult.OK
                Else
                    MessageBox.Show("El monto a debitar debe ser menor o igual que el saldo del anticipo elegido, verifique.", Me.Text, MessageBoxButtons.OK, MessageBoxIcon.Exclamation)
                End If
            Else
                If TxtMontoAnticipo.Text.Trim = "" Then
                    TxtMontoAnticipo.Text = "0"
                    MessageBox.Show("Por favor ingrese un monto para el pago", Me.Text, MessageBoxButtons.OK, MessageBoxIcon.Exclamation)
                End If
                If visibleSelectedRowCount = False Or TxtMontoAnticipo.Text = "" Then
                    MessageBox.Show("Debe seleccionar un anticipo y escribir el monto, verifique.", Me.Text, MessageBoxButtons.OK, MessageBoxIcon.Exclamation)
                End If
            End If

        Catch ex As Exception
            MessageBox.Show(ex.Message, Me.Text, MessageBoxButtons.OK, MessageBoxIcon.Error)
        End Try
    End Sub

    Private Function AgruparDebitoAnticipo(Anticipos As List(Of DebitoAnticipo)) As List(Of DebitoAnticipo)
        Dim Agrupados As New List(Of DebitoAnticipo)

        Dim Agrupado As List(Of DebitoAnticipo) = (From anticipo In Anticipos
                                                   Group anticipo By keys = New With {Key anticipo.anio, Key anticipo.folio}
                       Into Group
                                                   Select New DebitoAnticipo With {.anio = keys.anio, .folio = keys.folio,
                                        .montodebitado = Group.Sum(Function(x) x.montodebitado)}).Take(200).ToList()


        Return Agrupado

    End Function

    Private Sub ActualizarSaldoAnticipo(dtAnticipos As DataTable, Agrupados As List(Of DebitoAnticipo))
        If dtAnticipos IsNot Nothing And dtAnticipos.Rows.Count > 0 Then
            For Each agrupado As DebitoAnticipo In Agrupados
                For Each row As DataRow In dtAnticipos.Rows
                    If Not row.RowState.ToString().Contains("Deleted") Then
                        If row("AñoMovimiento").ToString = agrupado.anio.ToString And row("FolioMovimiento").ToString = agrupado.folio.ToString Then
                            row("MontoSaldo") = Convert.ToDecimal(row("MontoSaldo")) - agrupado.montodebitado
                        End If
                    End If
                Next
            Next
        Else
            Throw New Exception("El cliente no tiene anticipos, la operación solicitada no es válida.")
        End If

    End Sub
    Private Sub EliminaSaldosCeros(dtAnticipos As DataTable)
        For Each row As DataRow In dtAnticipos.Rows
            If Convert.ToDecimal(row("MontoSaldo")) = 0 Then
                row.Delete()
            End If
        Next
    End Sub

    Public Sub LimpiarVales()
        txtClienteVales.Clear()
        LabelNombreVales.Text = ""
        FechaDocumentoVales.Text = ""
        ComboProveedor.SelectedIndex = 0
        ComboTipoVale.SelectedIndex = 0
        TxtMontoVales.Clear()
        TextObservacionesVales.Clear()

    End Sub

    Public Sub LimpiarAnticipo()
        TxtClienteAplicAntic.Clear()
        LabelNombreApAntic.Text = ""
        dgvSaldoAnticipo.DataSource = Nothing
        TxtMontoAnticipo.Clear()
        TextObservacionesAnticipo.Clear()

    End Sub

    Private Sub TxtClienteAplicAntic_TextChanged(sender As Object, e As EventArgs) Handles TxtClienteAplicAntic.TextChanged

    End Sub

    Private Sub TxtClienteAplicAntic_KeyPress(sender As Object, e As KeyPressEventArgs) Handles TxtClienteAplicAntic.KeyPress
        '97 - 122 = Ascii MINÚSCULAS
        '65 - 90  = Ascii MAYÚSCULAS
        '48 - 57  = Ascii NÚMEROS

        If Asc(e.KeyChar) <> 8 Then
            If Asc(e.KeyChar) < 46 Or Asc(e.KeyChar) < 48 Or Asc(e.KeyChar) > 57 Then
                e.Handled = True
            End If
        End If
    End Sub

    Private Sub BotonBase3_Click(sender As Object, e As EventArgs) Handles BotonBase3.Click
        DialogResult = DialogResult.OK
    End Sub


    Private Sub TxtNumeroDecimal1_KeyPress(sender As Object, e As KeyPressEventArgs) Handles Txt_totalEfectivo.KeyPress
        If Asc(e.KeyChar) <> 8 Then
            If Asc(e.KeyChar) < 46 Or Asc(e.KeyChar) < 48 Or Asc(e.KeyChar) > 57 Then
                e.Handled = True
            End If
        End If
        If e.KeyChar = "." Then
            e.Handled = False
        End If
        If Asc(e.KeyChar) = 13 Then
            btnEfectivo.PerformClick()

        End If
    End Sub

    Private Sub txtClienteVales_KeyPress(sender As Object, e As KeyPressEventArgs) Handles txtClienteVales.KeyPress
        '97 - 122 = Ascii MINÚSCULAS
        '65 - 90  = Ascii MAYÚSCULAS
        '48 - 57  = Ascii NÚMEROS

        If Asc(e.KeyChar) <> 8 Then
            If Asc(e.KeyChar) < 46 Or Asc(e.KeyChar) < 48 Or Asc(e.KeyChar) > 57 Then
                e.Handled = True
            End If
        End If

    End Sub

    Private Sub TxtMontoVales_KeyPress(sender As Object, e As KeyPressEventArgs) Handles TxtMontoVales.KeyPress
        '97 - 122 = Ascii MINÚSCULAS
        '65 - 90  = Ascii MAYÚSCULAS
        '48 - 57  = Ascii NÚMEROS

        If Asc(e.KeyChar) <> 8 Then
            If Asc(e.KeyChar) < 46 Or Asc(e.KeyChar) < 48 Or Asc(e.KeyChar) > 57 Then
                e.Handled = True
            End If
        End If

        If e.KeyChar = "." Then
            e.Handled = False
        End If
    End Sub

    Private Sub txtClienteTC_KeyPress(sender As Object, e As KeyPressEventArgs) Handles txtClienteTC.KeyPress
        '97 - 122 = Ascii MINÚSCULAS
        '65 - 90  = Ascii MAYÚSCULAS
        '48 - 57  = Ascii NÚMEROS

        If Asc(e.KeyChar) <> 8 Then
            If Asc(e.KeyChar) < 46 Or Asc(e.KeyChar) < 48 Or Asc(e.KeyChar) > 57 Then
                e.Handled = True
            End If
        End If

    End Sub

    Private Sub txtImporteTC_KeyPress(sender As Object, e As KeyPressEventArgs) Handles txtImporteTC.KeyPress
        '97 - 122 = Ascii MINÚSCULAS
        '65 - 90  = Ascii MAYÚSCULAS
        '48 - 57  = Ascii NÚMEROS

        If Asc(e.KeyChar) <> 8 Then
            If Asc(e.KeyChar) < 46 Or Asc(e.KeyChar) < 48 Or Asc(e.KeyChar) > 57 Then
                e.Handled = True
            End If
        End If

        If e.KeyChar = "." Then
            e.Handled = False
        End If
    End Sub

    Private Sub txtDocumento_KeyPress(sender As Object, e As KeyPressEventArgs) Handles txtDocumento.KeyPress
        '97 - 122 = Ascii MINÚSCULAS
        '65 - 90  = Ascii MAYÚSCULAS
        '48 - 57  = Ascii NÚMEROS

        If Asc(e.KeyChar) <> 8 Then
            If Asc(e.KeyChar) < 46 Or Asc(e.KeyChar) < 48 Or Asc(e.KeyChar) > 57 Then
                e.Handled = True
            End If
        End If

    End Sub

    Private Sub txtClienteCheque_KeyPress(sender As Object, e As KeyPressEventArgs) Handles txtClienteCheque.KeyPress
        '97 - 122 = Ascii MINÚSCULAS
        '65 - 90  = Ascii MAYÚSCULAS
        '48 - 57  = Ascii NÚMEROS

        If Asc(e.KeyChar) <> 8 Then
            If Asc(e.KeyChar) < 46 Or Asc(e.KeyChar) < 48 Or Asc(e.KeyChar) > 57 Then
                e.Handled = True
            End If
        End If

    End Sub

    Private Sub txtImporteDocumento_KeyPress(sender As Object, e As KeyPressEventArgs) Handles txtImporteDocumento.KeyPress
        '97 - 122 = Ascii MINÚSCULAS
        '65 - 90  = Ascii MAYÚSCULAS
        '48 - 57  = Ascii NÚMEROS

        If Asc(e.KeyChar) <> 8 Then
            If Asc(e.KeyChar) < 46 Or Asc(e.KeyChar) < 48 Or Asc(e.KeyChar) > 57 Then
                e.Handled = True
            End If
        End If

        If e.KeyChar = "." Then
            e.Handled = False
        End If
    End Sub

    Private Sub TxtClienteTransferencia_KeyPress(sender As Object, e As KeyPressEventArgs) Handles TxtClienteTransferencia.KeyPress
        '97 - 122 = Ascii MINÚSCULAS
        '65 - 90  = Ascii MAYÚSCULAS
        '48 - 57  = Ascii NÚMEROS
        If Asc(e.KeyChar) <> 8 Then
            If Asc(e.KeyChar) < 46 Or Asc(e.KeyChar) < 48 Or Asc(e.KeyChar) > 57 Then
                e.Handled = True
            End If
        End If

    End Sub

    Private Sub TxtImporteTransferencia_KeyPress(sender As Object, e As KeyPressEventArgs) Handles TxtImporteTransferencia.KeyPress
        '97 - 122 = Ascii MINÚSCULAS
        '65 - 90  = Ascii MAYÚSCULAS
        '48 - 57  = Ascii NÚMEROS
        If Asc(e.KeyChar) <> 8 Then
            If Asc(e.KeyChar) < 46 Or Asc(e.KeyChar) < 48 Or Asc(e.KeyChar) > 57 Then
                e.Handled = True
            End If
        End If

        If e.KeyChar = "." Then
            e.Handled = False
        End If
    End Sub

    Private Sub TxtMontoAnticipo_KeyPress(sender As Object, e As KeyPressEventArgs) Handles TxtMontoAnticipo.KeyPress
        '97 - 122 = Ascii MINÚSCULAS
        '65 - 90  = Ascii MAYÚSCULAS
        '48 - 57  = Ascii NÚMEROS
        If Asc(e.KeyChar) <> 8 Then
            If Asc(e.KeyChar) < 46 Or Asc(e.KeyChar) < 48 Or Asc(e.KeyChar) > 57 Then
                e.Handled = True
            End If
        End If
        If e.KeyChar = "." Then
            e.Handled = False
        End If
    End Sub

    Private Sub TxtClienteDacionPago_KeyPress(sender As Object, e As KeyPressEventArgs) Handles TxtClienteDacionPago.KeyPress
        '97 - 122 = Ascii MINÚSCULAS
        '65 - 90  = Ascii MAYÚSCULAS
        '48 - 57  = Ascii NÚMEROS

        If Asc(e.KeyChar) <> 8 Then
            If Asc(e.KeyChar) < 46 Or Asc(e.KeyChar) < 48 Or Asc(e.KeyChar) > 57 Then
                e.Handled = True
            End If
        End If
    End Sub

    Private Sub TxtMontoDacionPago_KeyPress(sender As Object, e As KeyPressEventArgs) Handles TxtMontoDacionPago.KeyPress
        '97 - 122 = Ascii MINÚSCULAS
        '65 - 90  = Ascii MAYÚSCULAS
        '48 - 57  = Ascii NÚMEROS

        If Asc(e.KeyChar) <> 8 Then
            If Asc(e.KeyChar) < 46 Or Asc(e.KeyChar) < 48 Or Asc(e.KeyChar) > 57 Then
                e.Handled = True
            End If
        End If
    End Sub

    Private Sub dgvSaldoAnticipo_CellContentClick(sender As Object, e As DataGridViewCellEventArgs) Handles dgvSaldoAnticipo.CellContentClick

        Dim Año, Folio, Saldo As String
        Dim Col As Integer = Me.dgvSaldoAnticipo.CurrentCell.ColumnIndex
        For Each fila As DataGridViewRow In Me.dgvSaldoAnticipo.Rows
            If fila.Selected Then
                Año = Convert.ToString(fila.Cells(0).Value)
                Folio = Convert.ToString(fila.Cells(1).Value)
                Saldo = Convert.ToString(fila.Cells(2).Value)
            End If
        Next
    End Sub

    Private Sub tbAplicAnticipo_Click(sender As Object, e As EventArgs) Handles tbAplicAnticipo.Click

    End Sub

    Private Sub frmSelTipoCobro_FormClosing(sender As Object, e As FormClosingEventArgs) Handles MyBase.FormClosing
        If (_Remisiones = True) Then
            e.Cancel = True
            _Remisiones = False
        End If

    End Sub

    Private Sub tbTarjetaCredito_Click(sender As Object, e As EventArgs) Handles tbTarjetaCredito.Click

    End Sub

    Private Sub dgvCargoTarjeta_CellContentClick(sender As Object, e As DataGridViewCellEventArgs) Handles dgvCargoTarjeta.CellContentClick

    End Sub

    Private Sub grpTarjetaCredito_Enter(sender As Object, e As EventArgs) Handles grpTarjetaCredito.Enter

    End Sub

    Private Sub Button2_Click(sender As Object, e As EventArgs) Handles Button2.Click

    End Sub
End Class




>>>>>>> development
